!function(){"use strict";function t(t){return'\n    <main>\n      <input class="input-add"/>\n      <button class="btn-add">Add</button>\n      <div>'+t.todos.map(function(t){return'\n    <div>\n      <span class="todo '+(t.done?"done":"pending")+'">\n        '+t.text+'\n      </span>\n      <button data-id="'+t.id+'" class="btn-delete">\n        Delete\n      </button>\n\n      <span>\n        <input data-id="'+t.id+'"/>\n        <button data-id="'+t.id+'" class="btn-update">\n          Update\n        </button>\n        <button\n          data-id="'+t.id+'"\n          class="btn-finish '+(t.done?"done":"pending")+'"\n        >\n          Finish\n        </button>\n        <button\n          data-id="'+t.id+'"\n          class="btn-redo '+(t.done?"done":"pending")+'"\n        >\n          Redo\n        </button>\n      </span>\n    </div>\n  '}).join("")+"</div>\n    </main>\n  "}var e=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},n=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),o=function t(e,n,o){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var r=Object.getPrototypeOf(e);return null===r?void 0:t(r,n,o)}if("value"in i)return i.value;var d=i.get;if(void 0!==d)return d.call(o)},i=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},d=function(){function t(n){e(this,t),this.data=n,this.subscribers=[]}return n(t,[{key:"publish",value:function(t){this.subscribers.forEach(function(e){return e(t)})}}]),t}(),u=function(){function t(n){var o=this;e(this,t),this.el=document.querySelector(n.el),this.model=n.model,this.view=n.view,this.render=this.render.bind(this),this.el.addEventListener("click",function(t){t.stopPropagation(),Object.keys(n.onClick||{}).forEach(function(e){t.path[0].matches(e)&&n.onClick[e].call(o,t)})})}return n(t,[{key:"getTargetAttr",value:function(t,e){return t.path[0].getAttribute(e)}},{key:"getChild",value:function(t){return this.el.querySelector(t)}},{key:"render",value:function(){this.el.innerHTML=this.view(this.model)}}]),t}(),a=function(t){function o(){return e(this,o),r(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,{todos:[]}))}return i(o,t),n(o,[{key:"todos",get:function(){return this.data.todos},set:function(t){this.data.todos=t,this.publish(t)}}]),o}(d);new(function(t){function d(t,n){e(this,d);var o=r(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,{model:t,view:n,el:"#app",onClick:{".btn-add":function(){this.model.todos=this.model.todos.concat([{id:(new Date).getTime().toString(),done:!1,text:this.addInputText}])},".btn-delete":function(t){var e=this.getTargetAttr(t,"data-id");this.model.todos=this.model.todos.filter(function(t){return t.id!==e})},".btn-update":function(t){var e=this.getTargetAttr(t,"data-id"),n=this.getUpdateText(e);this.model.todos=this.model.todos.map(function(t){return{id:t.id,done:t.done,text:t.id===e?n:t.text}})},".btn-redo":function(t){var e=this.getTargetAttr(t,"data-id");this.model.todos=this.model.todos.map(function(t){return{id:t.id,done:t.id!==e&&t.done,text:t.text}})},".btn-finish":function(t){var e=this.getTargetAttr(t,"data-id");this.model.todos=this.model.todos.map(function(t){return{id:t.id,done:t.id===e||t.done,text:t.text}})}}}));return o.model.subscribers.push(o.render),o}return i(d,t),n(d,[{key:"getUpdateText",value:function(t){return o(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"getChild",this).call(this,'input[data-id="'+t+'"]').value}},{key:"addInputText",get:function(){return o(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"getChild",this).call(this,".input-add").value}}]),d}(u))(new a,t).render()}();
